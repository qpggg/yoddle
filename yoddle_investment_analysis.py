import matplotlib.pyplot as plt
import pandas as pd
import numpy as np

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —à—Ä–∏—Ñ—Ç–æ–≤ –¥–ª—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã
plt.rcParams['font.family'] = ['DejaVu Sans', 'Verdana', 'Tahoma']
plt.rcParams['axes.unicode_minus'] = False

# –ò–ù–í–ï–°–¢–ò–¶–ò–û–ù–ù–ê–Ø –≤–µ—Ä—Å–∏—è –¥–∞–Ω–Ω—ã—Ö (–æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ, –Ω–æ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ)
years = [2023, 2024, 2025, 2026, 2027, 2028, 2029, 2030]

# –î–∞–Ω–Ω—ã–µ —Å —É–º–µ—Ä–µ–Ω–Ω—ã–º –æ–ø—Ç–∏–º–∏–∑–º–æ–º –¥–ª—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤
data = {
    '–ì–∏–±–∫–∏–µ –ª—å–≥–æ—Ç—ã': [2, 4, 7, 11, 16, 22, 28, 35],             # –ù–∞—à –æ—Å–Ω–æ–≤–Ω–æ–π —Ä—ã–Ω–æ–∫
    '–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è HR': [5, 8, 12, 18, 25, 32, 38, 45],         # Excel ‚Üí –æ–±–ª–∞—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
    '–£–¥–∞–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞': [42, 48, 54, 60, 66, 71, 75, 78],       # COVID —É—Å–∫–æ—Ä–∏–ª —Ç—Ä–µ–Ω–¥
    '–û–±—É—á–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞': [8, 12, 17, 24, 32, 40, 47, 54],      # –ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è –∑–∞ —Ç–∞–ª–∞–Ω—Ç—ã
    'Wellness –ø—Ä–æ–≥—Ä–∞–º–º—ã': [1, 2, 4, 7, 11, 16, 22, 28]          # –ú–µ–¥–ª–µ–Ω–Ω—ã–π, –Ω–æ —Ä–∞—Å—Ç—É—â–∏–π
}

# –°–æ–∑–¥–∞–Ω–∏–µ DataFrame
df = pd.DataFrame(data)
df.index = years

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
fig, ax = plt.subplots(figsize=(16, 11))

# –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ü–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞
colors = ['#E74C3C', '#27AE60', '#3498DB', '#F39C12', '#9B59B6']

# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ª–∏–Ω–∏–π —Å –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –±–µ–∑ –Ω–∞–ª–æ–∂–µ–Ω–∏–π
offset_shifts = [20, 15, 10, 25, 5]  # –†–∞–∑–Ω—ã–µ —Å–º–µ—â–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π –ª–∏–Ω–∏–∏

for i, (trend, color) in enumerate(zip(df.columns, colors)):
    line = ax.plot(years, df[trend], marker='o', linewidth=3, markersize=10, 
                   color=color, label=trend, alpha=0.9, markerfacecolor='white',
                   markeredgewidth=2, markeredgecolor=color)
    
    # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Å —É–º–Ω—ã–º —Å–º–µ—â–µ–Ω–∏–µ–º
    for year, value in zip(years, df[trend]):
        y_offset = offset_shifts[i]
        ax.annotate(f'{value}%', (year, value), textcoords="offset points", 
                   xytext=(0, y_offset), ha='center', fontsize=8, fontweight='bold',
                   color=color, bbox=dict(boxstyle="round,pad=0.15", 
                   facecolor='white', edgecolor=color, alpha=0.9))

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Å–µ–π
ax.set_xlabel('–ì–æ–¥', fontsize=15, fontweight='bold')
ax.set_ylabel('–ü—Ä–æ—Ü–µ–Ω—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤ SMB (%)', fontsize=15, fontweight='bold')
ax.set_title('HR-—Ç—Ä–µ–Ω–¥—ã –≤ —Ä–æ—Å—Å–∏–π—Å–∫–æ–º SMB: –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–æ—Å—Ç–∞\n(–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ Yoddle)', 
             fontsize=18, fontweight='bold', pad=25)

# –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–µ—Ç–∫–∞
ax.grid(True, alpha=0.3, linestyle='--', linewidth=0.8)
ax.set_xlim(2022.7, 2030.3)
ax.set_ylim(-2, 88)

# –õ–µ–≥–µ–Ω–¥–∞
legend = ax.legend(loc='upper left', fontsize=13, framealpha=0.95, 
                  fancybox=True, shadow=True)
legend.get_frame().set_facecolor('#F8F9FA')
legend.get_frame().set_edgecolor('#34495E')

# –ö–ª—é—á–µ–≤—ã–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –¥–ª—è –∏–Ω–≤–µ—Å—Ç–æ—Ä–æ–≤
ax.annotate('Yoddle –∑–∞–ø—É—Å–∫ Q4 2025\n–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Ö–æ–¥–∞\n(7% –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ —Ä—ã–Ω–∫–∞)', 
            xy=(2025.75, 7), xytext=(2025.5, 35),
            arrowprops=dict(arrowstyle='->', color='#E74C3C', lw=2),
            fontsize=11, ha='left', fontweight='bold',
            bbox=dict(boxstyle="round,pad=0.4", facecolor='#FADBD8', 
                     edgecolor='#E74C3C', alpha=0.9))

ax.annotate('2027-2030:\n–ë—É–º —Ä–æ—Å—Ç–∞ —Ä—ã–Ω–∫–∞\n35% –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ', 
            xy=(2029, 35), xytext=(2027, 55),
            arrowprops=dict(arrowstyle='->', color='#27AE60', lw=2),
            fontsize=11, ha='center', fontweight='bold',
            bbox=dict(boxstyle="round,pad=0.4", facecolor='#D5F4E6', 
                     edgecolor='#27AE60', alpha=0.9))

ax.annotate('–£–¥–∞–ª–µ–Ω–∫–∞ —Å–æ–∑–¥–∞—ë—Ç\n—Å–ø—Ä–æ—Å –Ω–∞ —Ü–∏—Ñ—Ä–æ–≤—ã–µ\nHR-—Ä–µ—à–µ–Ω–∏—è', 
            xy=(2026, 60), xytext=(2024.5, 70),
            arrowprops=dict(arrowstyle='->', color='#3498DB', lw=2),
            fontsize=11, ha='center', fontweight='bold',
            bbox=dict(boxstyle="round,pad=0.4", facecolor='#D6EAF8', 
                     edgecolor='#3498DB', alpha=0.9))

# 3 –±–ª–æ–∫–∞ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ Yoddle –≤ —Ä—è–¥
tech_advantages = """
‚ö° –¢–ï–•–ù–û–õ–û–ì–ò–ò
‚Ä¢ –ì–æ—Ç–æ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Å 
  –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–µ–π (XP, —Ä–∞–Ω–≥–∏)
‚Ä¢ AI-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ª—å–≥–æ—Ç
  –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚Ä¢ –°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏
  –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
‚Ä¢ –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚Ä¢ API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
"""

business_advantages = """
üí∞ –ë–ò–ó–ù–ï–°-–ú–û–î–ï–õ–¨
‚Ä¢ 9,500‚ÇΩ –∑–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞/–º–µ—Å
‚Ä¢ 2 –ø—Ä–µ–º–∏—É–º –ª—å–≥–æ—Ç—ã –≤–∫–ª—é—á–µ–Ω—ã
‚Ä¢ –û—Ç–¥–µ–ª 30 —á–µ–ª = 285,000‚ÇΩ/–º–µ—Å
‚Ä¢ –ë—ã—Å—Ç—Ä–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞ 15 –º–∏–Ω
‚Ä¢ "–õ—å–≥–æ—Ç—ã –±–µ–∑ –±—é—Ä–æ–∫—Ä–∞—Ç–∏–∏"
‚Ä¢ –°—Ç–∞—Ä—Ç Q4 2025
"""

market_advantages = """
üöÄ –ú–ê–†–ö–ï–¢ –¢–ê–ô–ú–ò–ù–ì
‚Ä¢ First-mover: 2% –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ
‚Ä¢ –†–∞—Å—Ç—É—â–∏–π —Ä—ã–Ω–æ–∫ +25% CAGR
‚Ä¢ –ù–∏–∑–∫–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è –≤ SMB
‚Ä¢ COVID —É—Å–∫–æ—Ä–∏–ª –¥–∏–¥–∂–∏—Ç–∞–ª–∏–∑–∞—Ü–∏—é
‚Ä¢ –î–µ—Ñ–∏—Ü–∏—Ç –∫–∞–¥—Ä–æ–≤ ‚Üí —Å–ø—Ä–æ—Å –Ω–∞ –ª—å–≥–æ—Ç—ã
‚Ä¢ –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª —ç–∫—Å–ø–∞–Ω—Å–∏–∏ –≤ –°–ù–ì
"""

# –†–∞–∑–º–µ—â–µ–Ω–∏–µ 3 –±–ª–æ–∫–æ–≤ –≤ —Ä—è–¥ (–ø–æ–¥–Ω–∏–º–∞–µ–º –≤—ã—à–µ)
ax.text(0.02, -0.22, tech_advantages, transform=ax.transAxes, fontsize=9,
        verticalalignment='top', horizontalalignment='left',
        bbox=dict(boxstyle="round,pad=0.5", facecolor='#E3F2FD', 
                 edgecolor='#2196F3', alpha=0.95, linewidth=1.5))

ax.text(0.35, -0.22, business_advantages, transform=ax.transAxes, fontsize=9,
        verticalalignment='top', horizontalalignment='left',
        bbox=dict(boxstyle="round,pad=0.5", facecolor='#FFF3E0', 
                 edgecolor='#FF9800', alpha=0.95, linewidth=1.5))

ax.text(0.68, -0.22, market_advantages, transform=ax.transAxes, fontsize=9,
        verticalalignment='top', horizontalalignment='left',
        bbox=dict(boxstyle="round,pad=0.5", facecolor='#E8F5E8', 
                 edgecolor='#4CAF50', alpha=0.95, linewidth=1.5))

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ç—Å—Ç—É–ø —Å–Ω–∏–∑—É –¥–ª—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –±–ª–æ–∫–æ–≤
plt.subplots_adjust(bottom=0.25)

plt.tight_layout()
plt.show()

# –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
input("\nüëÜ –ì—Ä–∞—Ñ–∏–∫ –æ—Ç–∫—Ä—ã—Ç! –ó–∞–∫—Ä–æ–π—Ç–µ –æ–∫–Ω–æ –≥—Ä–∞—Ñ–∏–∫–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...")

# –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑
print("\n" + "="*80)
print("üöÄ YODDLE: –ò–ù–í–ï–°–¢–ò–¶–ò–û–ù–ù–´–ï –í–û–ó–ú–û–ñ–ù–û–°–¢–ò –í HR-TECH SMB")
print("="*80)

print(f"\nüíº –†–´–ù–û–ß–ù–ê–Ø –°–ò–¢–£–ê–¶–ò–Ø:")
for year in [2024, 2027, 2030]:
    benefits_penetration = df.loc[year, '–ì–∏–±–∫–∏–µ –ª—å–≥–æ—Ç—ã']
    market_size = 6000000 * benefits_penetration / 100
    print(f"   {year}: {benefits_penetration}% –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ = {market_size/1000:.0f}–ö –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤")

print(f"\nüìä –ù–û–í–ê–Ø –ë–ò–ó–ù–ï–°-–ú–û–î–ï–õ–¨ YODDLE (–ü–†–ï–ú–ò–£–ú –°–ï–ì–ú–ï–ù–¢):")
print("üéØ –¶–ï–ù–û–û–ë–†–ê–ó–û–í–ê–ù–ò–ï:")
print("   ‚Ä¢ 9,500‚ÇΩ –∑–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –≤ –º–µ—Å—è—Ü")
print("   ‚Ä¢ 2 –ø—Ä–µ–º–∏—É–º –ª—å–≥–æ—Ç—ã –≤–∫–ª—é—á–µ–Ω—ã –≤ —Å—Ç–æ–∏–º–æ—Å—Ç—å")
print("   ‚Ä¢ –û—Ç–¥–µ–ª 30 —á–µ–ª–æ–≤–µ–∫ = 285,000‚ÇΩ/–º–µ—Å")
print("   ‚Ä¢ –§–æ–∫—É—Å –Ω–∞ –ø—Ä–µ–º–∏—É–º SMB —Å –≤—ã—Å–æ–∫–æ–π –º–∞—Ä–∂–æ–π")
print("   ‚Ä¢ –°—Ç–∞—Ä—Ç –ø—Ä–æ–¥–∞–∂: Q4 2025")

print(f"\nüí∞ –§–ò–ù–ê–ù–°–û–í–´–ï –ü–†–û–ì–ù–û–ó–´ (–ü–†–ï–ú–ò–£–ú –ú–û–î–ï–õ–¨):")
# –ú–µ–Ω—å—à–µ –∫–ª–∏–µ–Ω—Ç–æ–≤, –Ω–æ –Ω–∞–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ ARPU
conservative_clients = [0, 0, 5, 15, 35, 70, 120, 200]  # –°—Ç–∞—Ä—Ç —Å Q4 2025
# –°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä –æ—Ç–¥–µ–ª–∞ 25 —á–µ–ª–æ–≤–µ–∫ * 9,500‚ÇΩ = 237,500‚ÇΩ/–º–µ—Å
avg_revenue = [0, 0, 240000, 235000, 230000, 225000, 220000, 215000]  # –ü—Ä–µ–º–∏—É–º —Ü–µ–Ω—ã

for i, year in enumerate(years):
    clients = conservative_clients[i]
    revenue = clients * avg_revenue[i] * 12 / 1000000  # –í –º–ª–Ω —Ä—É–±–ª–µ–π
    print(f"   {year}: {clients:,} –∫–ª–∏–µ–Ω—Ç–æ–≤ ‚Ä¢ {revenue:.1f}–ú‚ÇΩ ARR")

print(f"\nüé™ –ö–õ–Æ–ß–ï–í–´–ï –ú–ï–¢–†–ò–ö–ò –ö 2030 (–ü–†–ï–ú–ò–£–ú –°–ï–ì–ú–ï–ù–¢):")
final_clients = conservative_clients[-1]
final_arr = final_clients * avg_revenue[-1] * 12 / 1000000
market_share = (final_clients / (6000000 * 35 / 100)) * 100

print(f"   ‚Ä¢ ARR: {final_arr:.0f}–ú‚ÇΩ")
print(f"   ‚Ä¢ –ü—Ä–µ–º–∏—É–º –∫–ª–∏–µ–Ω—Ç–æ–≤: {final_clients:,}")
print(f"   ‚Ä¢ –°—Ä–µ–¥–Ω–∏–π ARPU: {avg_revenue[-1]*12/1000000:.1f}–ú‚ÇΩ/–≥–æ–¥ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞")
print(f"   ‚Ä¢ –§–æ–∫—É—Å –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ, –Ω–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ")
print(f"   ‚Ä¢ –í—ã—Å–æ–∫–∞—è –º–∞—Ä–∂–∞ –∏ LTV")

print(f"\nüöÄ INVESTMENT HIGHLIGHTS (–ü–†–ï–ú–ò–£–ú –°–¢–†–ê–¢–ï–ì–ò–Ø):")
print("   ‚Ä¢ üìà –†–∞—Å—Ç—É—â–∏–π —Ä—ã–Ω–æ–∫: +25% CAGR –≥–∏–±–∫–∏—Ö –ª—å–≥–æ—Ç")
print("   ‚Ä¢ üíé –ü—Ä–µ–º–∏—É–º –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ: 9,500‚ÇΩ –∑–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞")
print("   ‚Ä¢ ‚ö° –ì–æ—Ç–æ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Å –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ AI-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏")
print("   ‚Ä¢ üéØ –í—ã—Å–æ–∫–∏–π ARPU: 2.6–ú‚ÇΩ/–≥–æ–¥ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞")
print("   ‚Ä¢ üí∞ –ë—ã—Å—Ç—Ä—ã–π –ø—É—Ç—å –∫ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏ –∑–∞ —Å—á–µ—Ç –≤—ã—Å–æ–∫–æ–π –º–∞—Ä–∂–∏")
print("   ‚Ä¢ üåç –ü—Ä–µ–º–∏—É–º —Å–µ–≥–º–µ–Ω—Ç –º–µ–Ω–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –∫—Ä–∏–∑–∏—Å–∞–º")
print("   ‚Ä¢ üìä –ú–µ–Ω—å—à–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ = –º–µ–Ω—å—à–µ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É")

print(f"\nüéØ –°–¢–†–ê–¢–ï–ì–ò–Ø –ü–†–ò–í–õ–ï–ß–ï–ù–ò–Ø –ò–ù–í–ï–°–¢–ò–¶–ò–ô (–ü–†–ï–ú–ò–£–ú –ú–û–î–ï–õ–¨):")
print("   ‚Ä¢ Seed: 15-30–ú‚ÇΩ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã –∏ –∑–∞–ø—É—Å–∫–∞ Q4 2025")
print("   ‚Ä¢ Series A: 50-80–ú‚ÇΩ –¥–ª—è –ø—Ä–µ–º–∏—É–º –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞ –∏ –ø—Ä–æ–¥–∞–∂")
print("   ‚Ä¢ Series B: 100-150–ú‚ÇΩ –¥–ª—è —ç–∫—Å–ø–∞–Ω—Å–∏–∏ –≤ –°–ù–ì")
print("   ‚Ä¢ –§–æ–∫—É—Å –Ω–∞ high-touch –ø—Ä–æ–¥–∞–∂–∏ –∏ premium experience")
print("   ‚Ä¢ KPIs: ARPU, LTV, –ø—Ä–µ–º–∏—É–º churn, premium NPS, –º–∞—Ä–∂–∞") 