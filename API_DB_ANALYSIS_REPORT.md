# üîç –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó API –ò –ë–î YODDLE

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

### 1. –î–£–ë–õ–ò–†–û–í–ê–ù–ò–ï –ö–û–î–ê
**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–æ–≥–∏–∫–∞ –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –≤ `server.js` –∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö API —Ñ–∞–π–ª–∞—Ö
- `server.js` —Å–æ–¥–µ—Ä–∂–∏—Ç 15+ API endpoints
- –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ `/api/` –¥—É–±–ª–∏—Ä—É—é—Ç —ç—Ç—É –ª–æ–≥–∏–∫—É
- –ù–µ—Ç –µ–¥–∏–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏—Å—Ç–∏–Ω—ã

**–í–ª–∏—è–Ω–∏–µ:** 
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- –†–∏—Å–∫ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∫–æ–¥–∞

### 2. –ü–†–û–ë–õ–ï–ú–´ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:**
- –ü–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ (—Å—Ç—Ä–æ–∫–∞ 47 –≤ server.js)
- –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç rate limiting
- –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π (—Ö–æ—Ç—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è)

### 3. –ü–†–û–ë–õ–ï–ú–´ –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò –ë–î
**–ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:**
```sql
-- –ü—Ä–æ–±–ª–µ–º–Ω—ã–π –∑–∞–ø—Ä–æ—Å –≤ /api/progress (—Å—Ç—Ä–æ–∫–∏ 161-238)
SELECT 
  a.code as id,
  a.name as title,
  a.description,
  a.icon,
  a.xp_reward as points,
  a.tier,
  a.requirement_type,
  a.requirement_value,
  a.requirement_action,
  CASE WHEN ua.achievement_id IS NOT NULL THEN true ELSE false END as unlocked,
  ua.unlocked_at
FROM achievements a
LEFT JOIN user_achievements ua ON a.code = ua.achievement_id AND ua.user_id = $1
WHERE a.is_active = true
ORDER BY a.tier ASC, a.xp_reward ASC
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è JOIN
- –ù–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –í–°–ï –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 4. –ü–†–û–ë–õ–ï–ú–´ –ê–†–•–ò–¢–ï–ö–¢–£–†–´ –ë–î
**–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã:**
- `enter` (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–º–µ—Å—Ç–æ `users`)
- `notifications` (–µ—Å—Ç—å SQL —Ñ–∞–π–ª—ã, –Ω–æ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è)
- `news` (–µ—Å—Ç—å SQL —Ñ–∞–π–ª—ã, –Ω–æ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è)

**–ü—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏:**
- –ú–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–æ–≤ —Å–æ–∑–¥–∞–Ω–æ, –Ω–æ –Ω–µ –≤—Å–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ù–µ—Ç –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏

## üìä –ê–ù–ê–õ–ò–ó API ENDPOINTS

### –¢–µ–∫—É—â–∏–µ endpoints –≤ server.js:
1. `POST /api/login` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
2. `GET /api/activity` - –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. `GET /api/benefits` - —Å–ø–∏—Å–æ–∫ –ª—å–≥–æ—Ç
4. `GET /api/progress` - –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
5. `POST /api/progress` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
6. `PATCH /api/progress` - —á–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
7. `GET /api/user-benefits` - –ª—å–≥–æ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
8. `POST /api/user-benefits` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª—å–≥–æ—Ç
9. `POST /api/clients` - –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –∑–∞—è–≤–∫–∏
10. `GET /api/profile` - –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
11. `PATCH /api/profile` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
12. `GET /api/notifications` - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
13. `GET /api/user-recommendations` - —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
14. `POST /api/user-recommendations` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
15. `DELETE /api/user-recommendations` - —É–¥–∞–ª–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

### –ü—Ä–æ–±–ª–µ–º—ã –∫–∞–∂–¥–æ–≥–æ endpoint:

#### 1. `/api/login`
- –ü–∞—Ä–æ–ª–∏ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
- –ù–µ—Ç JWT —Ç–æ–∫–µ–Ω–æ–≤
- –ù–µ—Ç —Å–µ—Å—Å–∏–π

#### 2. `/api/activity`
- –°–ª–æ–∂–Ω—ã–π –∑–∞–ø—Ä–æ—Å –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞ –≤–µ—Å—å –º–µ—Å—è—Ü

#### 3. `/api/benefits`
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –í–°–ï –ª—å–≥–æ—Ç—ã
- –ù–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- –ù–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

#### 4. `/api/progress`
- –°–∞–º—ã–π –ø—Ä–æ–±–ª–µ–º–Ω—ã–π endpoint
- –°–ª–æ–∂–Ω—ã–µ JOIN –∑–∞–ø—Ä–æ—Å—ã
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
- –ù–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

#### 5. `/api/user-recommendations`
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏
- –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–±–ª–µ–º—ã —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏

## üóÑÔ∏è –ü–†–û–ë–õ–ï–ú–´ –°–¢–†–£–ö–¢–£–†–´ –ë–î

### –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Å–≤—è–∑–∏:
- –ù–µ—Ç foreign keys –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏
- –ù–∞—Ä—É—à–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–æ–±–ª–µ–º—ã —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏:
```sql
-- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã:
CREATE INDEX idx_achievements_user_id ON user_achievements(user_id, achievement_id);
CREATE INDEX idx_activity_log_user_date ON activity_log(user_id, created_at);
CREATE INDEX idx_user_benefits_user_category ON user_benefits(user_id, benefit_id);
CREATE INDEX idx_notifications_user_read ON notifications(user_id, is_read);
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö:
- `VARCHAR(255)` –≤–µ–∑–¥–µ (–Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ)
- –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ –¥–∞–Ω–Ω—ã–µ
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç CHECK constraints

## üöÄ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Æ

### 1. –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1-2 –¥–Ω—è):
- –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ SQL —Ñ–∞–π–ª—ã –∏–∑ –ø–∞–ø–∫–∏
- –î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∏–Ω–¥–µ–∫—Å—ã
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö

### 2. –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1 –Ω–µ–¥–µ–ª—è):
- –í–Ω–µ–¥—Ä–∏—Ç—å JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
- –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã
- –î–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é

### 3. –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (2 –Ω–µ–¥–µ–ª–∏):
- –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã

## üìà –û–ñ–ò–î–ê–ï–ú–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- **–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ API:** -70% (—Å 500ms –¥–æ 150ms)
- **–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ë–î:** -60%
- **–ü–∞–º—è—Ç—å:** -40%
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** +100%

### –î–ª—è 20,000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è:
- **2-3 —Å–µ—Ä–≤–µ—Ä–∞ –°–µ–Ω—å–æ—Ä+** (6 CPU, 8GB RAM –∫–∞–∂–¥—ã–π)
- **Redis** –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- **CDN** –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ 